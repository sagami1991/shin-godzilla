{"version":3,"sources":["service/UserService.ts"],"names":[],"mappings":";AAUA;IACC,qBAAoB,UAAsB;QAAtB,eAAU,GAAV,UAAU,CAAY;IAC1C,CAAC;IAEM,6BAAO,GAAd,UAAe,EAAU;QACxB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAC,GAAG,EAAE,EAAE,EAAC,CAAC,CAAC;IAC3C,CAAC;IAED,eAAe;IACR,+BAAS,GAAhB;QACC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;IACpE,CAAC;IAEM,gCAAU,GAAjB,UAAkB,IAAgB;QACjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;IACnD,CAAC;IAEM,gCAAU,GAAjB,UAAkB,IAAgB;QACjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAC,GAAG,EAAE,IAAI,CAAC,GAAG,EAAC,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC;IACpE,CAAC;IAEM,gCAAU,GAAjB,UAAkB,EAAU;QAC3B,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAC,GAAG,EAAE,EAAE,EAAC,CAAC,CAAC;IACtC,CAAC;IAEO,oCAAc,GAAtB,UAAuB,IAAgB;QACtC,MAAM,CAAC;YACN,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,IAAI,EAAE,IAAI,IAAI,EAAE;SAChB,CAAC;IACH,CAAC;IACF,kBAAC;AAAD,CAlCA,AAkCC,IAAA;AAlCY,mBAAW,cAkCvB,CAAA","file":"service/UserService.js","sourcesContent":["import {Collection} from 'mongodb';\r\n\r\nexport interface DbUserData {\r\n\t_id: string;\r\n\tlv: number;\r\n\tname: string;\r\n\texp: number;\r\n\tdate?: Date;\r\n}\r\n\r\nexport class UserService {\r\n\tconstructor(private collection: Collection) {\r\n\t}\r\n\r\n\tpublic getUser(id: string): Promise<DbUserData> {\r\n\t\treturn this.collection.findOne({_id: id});\r\n\t}\r\n\r\n\t/** 上位20人を返す */\r\n\tpublic getRanker(): Promise<DbUserData[]> {\r\n\t\treturn this.collection.find().limit(20).sort({ lv: -1 }).toArray();\r\n\t}\r\n\r\n\tpublic createUser(user: DbUserData) {\r\n\t\tthis.collection.insert(this.filterUserData(user));\r\n\t}\r\n\r\n\tpublic updateUser(user: DbUserData) {\r\n\t\tthis.collection.update({_id: user._id}, this.filterUserData(user));\r\n\t}\r\n\r\n\tpublic deleteUser(id: string) {\r\n\t\tthis.collection.deleteOne({_id: id});\r\n\t}\r\n\r\n\tprivate filterUserData(user: DbUserData): DbUserData {\r\n\t\treturn {\r\n\t\t\t_id: user._id,\r\n\t\t\tlv: user.lv,\r\n\t\t\tname: user.name,\r\n\t\t\texp: user.exp,\r\n\t\t\tdate: new Date()\r\n\t\t};\r\n\t}\r\n}"],"sourceRoot":"/source/"}